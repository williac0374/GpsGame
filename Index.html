<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Leaflet.js User Location</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <style>
        #map {
            height: 100vh;
            width: 100%;
        }
    </style>
</head>
<body>

<div id="map"></div>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script>
    const map = L.map('map').setView([0, 0], 2);

    // Terrain view
    L.tileLayer('https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png', {
        maxZoom: 17,
        attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors & <a href="https://opentopomap.org/copyright">OpenTopoMap</a>',
    }).addTo(map);

    let userMarker = L.marker([0, 0]).addTo(map);
    
    // Function to update the user's location
    function updateUserLocation(position) {
        const lat = position.coords.latitude;
        const lon = position.coords.longitude;
        const accuracy = position.coords.accuracy;

        // Update marker position
        userMarker.setLatLng([lat, lon]);
        map.setView([lat, lon], 15);

        // Optionally log the accuracy
        console.log(`Location Accuracy: ${accuracy} meters`);
    }

    // Function to handle geolocation errors
    function handleError(error) {
        console.error(`Geolocation error: ${error.message}`);
    }

    // Function to start watching the user's location
    function startTracking() {
        if (navigator.geolocation) {
            navigator.geolocation.watchPosition(updateUserLocation, handleError, {
                enableHighAccuracy: true,
                maximumAge: 10000, // Allow cached position up to 10 seconds
                timeout: 15000 // Timeout after 15 seconds
            });
        } else {
            alert('Geolocation is not supported by this browser.');
        }
    }

    // Start tracking the user's location
    startTracking();
</script>

</body>
</html>
